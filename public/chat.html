<!DOCTYPE html>
<html>  
  <head>  
    <title>An Ajax example</title> 
    <script> 
      var msg_count = 0;
      var myTextarea, myText, name;

      myTextarea = document.getElementById("myTextarea");  
         myText  = document.getElementById("myText"); 
         name  = document.getElementById("name"); 

       function sendMsg() {
            var xhr = false;
            if (window.ActiveXObject)
                xhr = new ActiveXObject("Microsoft.XMLHTTP");
            else if (window.XMLHttpRequest)
                xhr = new XMLHttpRequest();
            if (xhr) {
                xhr.open("GET", "/input?msg=" +myText.value + "&my=" + document.getElementById('name').value);
                xhr.onreadystatechange = function () {
                    if (xhr.readyState == 4) {
                        if (xhr.status != 200) {
                            alert("send ERROR");
                        }
                    }
                }
                xhr.send(null);
            }
        }

/* function getNewMessages() {
            let screen = document.querySelector("#screen");
            let data = { "count" : currMsgCount };
            
            sendAjax("/getNewMessages", JSON.stringify(data), function() {
                if( this.readyState == 4 && this.status == 200) {
                    let msgs = JSON.parse(this.responseText);
                    for(let i = 0; i < msgs.length; ++i)
                        screen.value += currMsgCount + "" + msgs[i].name + " : " + msgs[i].msg +  hours + ":" + minutes + "\n";
                    currMsgCount += msgs.length;
                }
                
            });
        }
        */
      function checkMessage()  
       {  
         var xhr = false;  
         if (window.ActiveXObject) 
              xhr = new  ActiveXObject("Microsoft.XMLHTTP"); 
         else if (window.XMLHttpRequest)  
                xhr = new XMLHttpRequest(); 
            if(xhr) { 
       var msg = "/getMessage?count=" + msg_count;  
                 xhr.open("GET", msg);
                 xhr.onreadystatechange = function()  
                 {  
                        if (xhr.readyState == 4 && xhr.status == 200) {  
         var msgs = JSON.parse(this.responseText);
         
         for(var i = 0 ; i < msgs.length ; ++i )   
         myTextarea.value += name[i] + ": " + msgs[i] + "\n\n";
         msg_count += msgs.length;
                         }  
                 }   
                 xhr.send(null);  
            }  
       }
      window.onload = function() {
         myTextarea = document.getElementById("myTextarea");  
         myText  = document.getElementById("myText"); 
         name  = document.getElementById("name"); 
         setInterval( function() {
            checkMessage();
         }, 2000);
      }
     </script> </head>
  <style>
       #name{
        width:70px;
          height:50px;
          font-size:10px;
        background:white;
    
      }
      #myText {
    width:250px;
    height:50px;
    font-size:10px;
background:white;
}

#myTextarea {
background-color:cadetblue;
float:center;
color:white;
}

#hola {
color:cadetblue;
float:center;
width:50px;height:50px;
}
  </style>
  <body> 
      <form> <div id="a">
        <table style="border: 1px solid; border-collapse: collapse;">   
        
            <tr style="border: solid 1px ;">     
    
                <th colspan="3"><textarea id="myTextarea" rows="35" cols="55" > </textarea></th>    
                 
            </tr>   
            <tr style="border: solid 1px ;">    
                         <th style="border: solid 1px ;"><input type="text" id="name" style="border: 0;"></input></th>    
                          <td style="border: 1px solid;"><input type="text" id="myText" style="border:0;" ></input></td> 
                        <th><input type="button" id="hola" onclick="sendMsg()" value="â–²" > </input></th>  
            </tr> 
        </table>
      </div></form></body></html>